<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MODA MAROC 2025</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js"></script>

<style>
body{margin:0;background:#0b0b0b;color:white;font-family:Arial}
header{background:black;padding:15px;text-align:center;border-bottom:1px solid gold}
h1{color:gold}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;padding:20px}
.card{background:#111;padding:15px;border-radius:15px;box-shadow:0 0 15px rgba(255,215,0,.3)}
.card img{width:100%;height:200px;object-fit:cover;border-radius:10px}
button{background:gold;border:none;padding:8px;width:100%;margin-top:5px;border-radius:8px;font-weight:bold;cursor:pointer}
.admin{position:fixed;bottom:20px;left:20px;background:red;color:white;padding:10px 15px;border-radius:30px}
#panel{position:fixed;top:0;left:0;width:100%;height:100%;background:black;display:none;padding:20px;overflow:auto}
input{width:100%;padding:8px;margin:5px 0;border-radius:6px;border:none}
</style>
</head>
<body>

<header><h1>MODA MAROC</h1></header>

<section class="products" id="products"></section>

<button class="admin" onclick="login()">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>

<div id="panel">
<h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©</h2>
<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
<input id="price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<input id="imageFile" type="file">
<button onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</button>
<button onclick="closePanel()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script type="module">

// ğŸ” Ø¶Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Firebase Ø¯ÙŠØ§Ù„Ùƒ Ù‡Ù†Ø§
const firebaseConfig = {
apiKey: "Ø¶Ø¹ Ù‡Ù†Ø§",
authDomain: "Ø¶Ø¹ Ù‡Ù†Ø§",
projectId: "Ø¶Ø¹ Ù‡Ù†Ø§",
storageBucket: "Ø¶Ø¹ Ù‡Ù†Ø§",
messagingSenderId: "Ø¶Ø¹ Ù‡Ù†Ø§",
appId: "Ø¶Ø¹ Ù‡Ù†Ø§"
};

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

const WHATSAPP="212712120673";
const ADMIN_CODE="1995";
let isAdmin=false;

async function loadProducts(){
const querySnapshot = await getDocs(collection(db,"products"));
let html="";
querySnapshot.forEach((docSnap)=>{
let p=docSnap.data();
html+=`
<div class="card">
<img src="${p.image}">
<h3>${p.name}</h3>
<p>${p.price} DH</p>
<button onclick="order('${p.name}',${p.price})">Ø§Ø·Ù„Ø¨</button>
${isAdmin ? `<button onclick="deleteProduct('${docSnap.id}')">Ø­Ø°Ù</button>`:""}
</div>`;
});
document.getElementById("products").innerHTML=html;
}
loadProducts();

window.order=function(name,price){
let msg="Ø£Ø±ÙŠØ¯ Ø·Ù„Ø¨ "+name+" Ø¨Ø³Ø¹Ø± "+price+" DH";
window.open("https://wa.me/"+WHATSAPP+"?text="+encodeURIComponent(msg));
}

window.login=function(){
let code=prompt("Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„");
if(code===ADMIN_CODE){
isAdmin=true;
document.getElementById("panel").style.display="block";
loadProducts();
}else alert("ÙƒÙˆØ¯ Ø®Ø§Ø·Ø¦");
}

window.closePanel=function(){
document.getElementById("panel").style.display="none";
}

window.addProduct=async function(){
let name=document.getElementById("name").value;
let price=document.getElementById("price").value;
let file=document.getElementById("imageFile").files[0];

if(!file)return alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø©");

let storageRef=ref(storage,"products/"+file.name);
await uploadBytes(storageRef,file);
let url=await getDownloadURL(storageRef);

await addDoc(collection(db,"products"),{
name:name,
price:price,
image:url
});

alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©");
loadProducts();
}

window.deleteProduct=async function(id){
if(confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ")){
await deleteDoc(doc(db,"products",id));
loadProducts();
}
}

</script>

</body>
</html>