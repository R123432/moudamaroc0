<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MODA MAROC - Secure Admin</title>

<style>
body{
margin:0;
background:#0b0b0b;
color:white;
font-family:Arial;
}

header{
background:black;
padding:15px;
text-align:center;
border-bottom:1px solid gold;
}

h1{color:gold}

.products{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:20px;
padding:20px;
}

.card{
background:#111;
padding:15px;
border-radius:15px;
box-shadow:0 0 15px rgba(255,215,0,.2);
}

.card img{
width:100%;
height:200px;
object-fit:cover;
border-radius:10px;
}

button{
background:gold;
border:none;
padding:8px;
width:100%;
margin-top:5px;
border-radius:8px;
cursor:pointer;
font-weight:bold;
}

.admin-btn{
position:fixed;
bottom:20px;
left:20px;
background:red;
color:white;
width:auto;
padding:10px 15px;
border-radius:30px;
}

/* ADMIN PANEL */
#adminPanel{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:#000;
display:none;
overflow:auto;
padding:20px;
}

input{
width:100%;
padding:8px;
margin:5px 0;
border-radius:6px;
border:none;
}

.close{
background:red;
}
</style>
</head>
<body>

<header>
<h1>MODA MAROC</h1>
</header>

<section class="products" id="products"></section>

<button class="admin-btn" onclick="login()">لوحة التحكم</button>

<div id="adminPanel">
<h2>لوحة التحكم المشفرة</h2>

<input id="name" placeholder="اسم المنتج">
<input id="price" type="number" placeholder="السعر">
<input id="image" placeholder="رابط الصورة">
<button onclick="addProduct()">إضافة منتج</button>

<h3>نسبة الخصم %</h3>
<input id="discountInput" type="number">
<button onclick="updateDiscount()">تحديث الخصم</button>

<button class="close" onclick="closeAdmin()">إغلاق</button>
</div>

<script>
const WHATSAPP="212712120673";
const ADMIN_CODE="1995";

let products=JSON.parse(localStorage.getItem("products")) || [];
let discount=localStorage.getItem("discount") || 0;

function saveData(){
localStorage.setItem("products",JSON.stringify(products));
localStorage.setItem("discount",discount);
}

function loadProducts(){
let html="";
products.forEach((p,i)=>{
let final=p.price-(p.price*discount/100);
html+=`
<div class="card">
<img src="${p.image}">
<h3>${p.name}</h3>
<p>${final} DH <del>${p.price}</del></p>
<button onclick="order('${p.name}',${final})">اطلب</button>
<button onclick="deleteProduct(${i})">حذف</button>
</div>`;
});
document.getElementById("products").innerHTML=html;
}
loadProducts();

function order(name,price){
let msg="أريد طلب "+name+" بسعر "+price+" DH";
window.open("https://wa.me/"+WHATSAPP+"?text="+encodeURIComponent(msg));
}

function login(){
let code=prompt("أدخل كود الدخول");
if(code===ADMIN_CODE){
document.getElementById("adminPanel").style.display="block";
document.getElementById("discountInput").value=discount;
}else{
alert("كود خاطئ");
}
}

function closeAdmin(){
document.getElementById("adminPanel").style.display="none";
}

function addProduct(){
let name=document.getElementById("name").value;
let price=document.getElementById("price").value;
let image=document.getElementById("image").value;

if(name && price && image){
products.push({name,price,image});
saveData();
loadProducts();
alert("تمت الإضافة");
}
}

function deleteProduct(i){
if(confirm("حذف المنتج؟")){
products.splice(i,1);
saveData();
loadProducts();
}
}

function updateDiscount(){
discount=document.getElementById("discountInput").value;
saveData();
loadProducts();
alert("تم تحديث الخصم");
}
</script>

</body>
</html>