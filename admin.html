<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة الإدارة</title>

<link rel="stylesheet" href="css/style.css">

<style>
body{
background:#0f0f0f;
color:white;
padding:20px;
font-family:Cairo;
}

.box{
background:#111;
padding:20px;
border-radius:10px;
max-width:800px;
margin:auto;
margin-bottom:20px;
}

h2,h3{
color:gold;
text-align:center;
margin-bottom:15px;
}

input{
width:100%;
padding:10px;
margin:8px 0;
background:#111;
border:1px solid gold;
color:white;
border-radius:8px;
}

.btn{
background:gold;
color:black;
padding:10px;
border:none;
cursor:pointer;
margin-top:10px;
width:100%;
font-weight:bold;
border-radius:8px;
}

.btn-red{
background:red;
color:white;
}

.item-box{
background:#1a1a1a;
padding:10px;
margin-top:10px;
border-radius:8px;
border:1px solid #333;
}
</style>
</head>

<body>

<!-- ===== تسجيل الدخول ===== -->

<div class="box" id="loginBox">
<h2>تسجيل دخول الإدارة</h2>

<input type="password" id="adminPass" placeholder="أدخل الكود السري">
<button onclick="login()" class="btn">دخول</button>
</div>

<!-- ===== لوحة التحكم ===== -->

<div id="adminPanel" style="display:none;">

<!-- إضافة منتج -->
<div class="box">
<h2>إضافة منتج</h2>

<input type="text" id="pName" placeholder="اسم المنتج">
<input type="number" id="pPrice" placeholder="الثمن">
<input type="number" id="pStock" placeholder="المخزون">
<input type="text" id="pImage" placeholder="رابط الصورة">

<button onclick="addProduct()" class="btn">إضافة منتج</button>

<button onclick="logout()" class="btn btn-red">
تسجيل الخروج
</button>
</div>

<!-- عرض المنتجات -->
<div class="box">
<h3>المنتجات الحالية</h3>
<div id="productList"></div>
</div>

<!-- عرض الطلبيات -->
<div class="box">
<h3>الطلبيات</h3>
<div id="ordersList"></div>
</div>

</div>

<script>

/* ===== حماية الصفحة ===== */

if(localStorage.getItem("adminLoggedIn")==="true"){
document.getElementById("loginBox").style.display="none";
document.getElementById("adminPanel").style.display="block";
loadProducts();
loadOrders();
}

/* ===== تسجيل الدخول ===== */

function login(){

let pass=document.getElementById("adminPass").value;

if(pass==="1995"){
localStorage.setItem("adminLoggedIn","true");

document.getElementById("loginBox").style.display="none";
document.getElementById("adminPanel").style.display="block";

loadProducts();
loadOrders();

}else{
alert("كود خاطئ ❌");
}

}

/* ===== تسجيل الخروج ===== */

function logout(){
localStorage.removeItem("adminLoggedIn");
location.reload();
}

/* ===== تحميل المنتجات ===== */

function loadProducts(){

let products=JSON.parse(localStorage.getItem("products")) || [];
const list=document.getElementById("productList");

list.innerHTML="";

products.forEach((p,index)=>{

list.innerHTML+=`
<div class="item-box">
<strong>${p.name}</strong><br>
الثمن: ${p.price} DH<br>
المخزون: ${p.stock}<br>
<button onclick="deleteProduct(${index})" class="btn btn-red" style="margin-top:5px;">
حذف
</button>
</div>
`;

});

}

/* ===== إضافة منتج ===== */

function addProduct(){

let name=document.getElementById("pName").value;
let price=document.getElementById("pPrice").value;
let stock=document.getElementById("pStock").value;
let image=document.getElementById("pImage").value;

if(!name || !price || !stock || !image){
alert("عمر جميع الحقول ❌");
return;
}

let products=JSON.parse(localStorage.getItem("products")) || [];

products.push({
id:Date.now(),
name:name,
price:Number(price),
stock:Number(stock),
image:image
});

localStorage.setItem("products",JSON.stringify(products));

alert("تمت الإضافة ✅");

document.getElementById("pName").value="";
document.getElementById("pPrice").value="";
document.getElementById("pStock").value="";
document.getElementById("pImage").value="";

loadProducts();
}

/* ===== حذف منتج ===== */

function deleteProduct(index){

let products=JSON.parse(localStorage.getItem("products")) || [];
products.splice(index,1);
localStorage.setItem("products",JSON.stringify(products));
loadProducts();
}

/* ===== تحميل الطلبيات ===== */

function loadOrders(){

let orders=JSON.parse(localStorage.getItem("orders")) || [];
const container=document.getElementById("ordersList");

container.innerHTML="";
let totalRevenue=0;

orders.forEach((order,index)=>{

totalRevenue+=order.total;

container.innerHTML+=`
<div class="item-box">
<strong>طلبية رقم: ${order.id}</strong><br>
التاريخ: ${order.date}<br>
المجموع: ${order.total} DH<br>
الحالة: ${order.status}<br>
<button onclick="changeStatus(${index})" class="btn" style="margin-top:5px;">
تغيير الحالة
</button>
</div>
`;
});

container.innerHTML+=`
<h3 style="margin-top:20px;color:gold;">
إجمالي الأرباح: ${totalRevenue} DH
</h3>
`;
}

/* ===== تغيير حالة الطلب ===== */

function changeStatus(index){

let orders=JSON.parse(localStorage.getItem("orders")) || [];

if(orders[index].status==="قيد المعالجة"){
orders[index].status="مكتمل";
}else{
orders[index].status="قيد المعالجة";
}

localStorage.setItem("orders",JSON.stringify(orders));
loadOrders();
}

</script>

</body>
</html>