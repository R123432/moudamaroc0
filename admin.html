<script>

const ADMIN_CODE = "1995";

function login(){
let pass = document.getElementById("adminPass").value;
if(pass === ADMIN_CODE){
document.getElementById("loginBox").style.display="none";
document.getElementById("adminPanel").style.display="block";
loadProducts();
}else{
alert("كود خاطئ");
}
}
let products = JSON.parse(localStorage.getItem("products")) || [];
let editIndex = null;

function save(){
localStorage.setItem("products", JSON.stringify(products));
}

function addProduct(){

let reader = new FileReader();
let file = let file = document.getElementById("pimage").files[0];
reader.onload = function(e){

let product = {
id: Date.now(),
name: pname.value,
price: Number(pprice.value),
stock: Number(pstock.value),
discount: Number(pdiscount.value),
image: e.target.result
};

if(editIndex !== null){
products[editIndex] = product;
editIndex = null;
}else{
products.push(product);
}

save();
loadProducts();
alert("تم الحفظ");
}

if(file){
reader.readAsDataURL(file);
}else{
alert("اختر صورة");
}
}

function loadProducts(){
let container = document.getElementById("adminProducts");
container.innerHTML="";

products.forEach((p,index)=>{
container.innerHTML += `
<div style="margin:10px 0;">
${p.name} - ${p.price} DH
<button onclick="editProduct(${index})">تعديل</button>
<button onclick="deleteProduct(${index})">حذف</button>
</div>
`;
});
}

function editProduct(index){
let p = products[index];

pname.value = p.name;
pprice.value = p.price;
pstock.value = p.stock;
pdiscount.value = p.discount;

editIndex = index;
}

function deleteProduct(index){
products.splice(index,1);
save();
loadProducts();
}

</script>